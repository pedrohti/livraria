@{
    ViewBag.Title = "Deletar";
    var id = @ViewBag.LivroId;
}

<h2> Tem certeza que deseja excluir este livro?</h2>

<form action="/" method="delete">
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">ISBN</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="isbn" disabled>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Autor</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="autor" disabled>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Titulo</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="titulo" disabled>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Preço</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="preco" disabled>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Data da Publicação</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="data" disabled>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Capa</label>
        <div class="col-sm-10">
            @*<input type="text" class="form-control" id="capa">*@
            <img id="capaAtual" style="width:90px;">
        </div>
    </div>
    <a href="/" class="btn btn-success">Voltar</a>
    <button type="submit" class="btn btn-danger">Deletar</button>
</form>



<script>
    $.ajax({
        type: 'GET',
        url: '/api/livro/' + @id,
        dataType: "json",
        success: (data) => {
            console.log(data)
            $("#isbn").val(data.ISBN);
            $("#autor").val(data.Autor);
            $("#titulo").val(data.Titulo);
            $("#preco").val(data.Preco);
            $("#data").val(data.DataPublicacao);
            $("#capa").val(data.Capa);
            $("#capaAtual").html(data.Titulo);
            $("#capaAtual").attr("src", data.Capa);
        }
    })


    $("form").submit((e) => {
        console.log("E", e)
        //e.preventDefault();

        var formData = {
            'Id': @id,
            'ISBN': $('input[id=isbn]').val(),
            'Autor': $('input[id=autor]').val(),
            'Titulo': $('input[id=titulo]').val(),
            'Preco': $('input[id=preco]').val(),
            'DataPublicacao': $('input[id=data]').val(),
            'Capa': $('input[id=capa]').val(),
        }

        $.ajax({
            type: 'DELETE',
            url: '/api/livro?id=' + @id,
            data: formData,
            dataType: 'json',
        }).done((data) => {
            console.log(data)
            //window.location.href = '/'
        })
        console.log(formData)
    })
</script>